<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{% static 'Associate_app/images/udaanredlogonew.png' %}" />

    <title>
        {% if request.user.is_staff %}
            Admin Dashboard
        {% else %}
            Dashboard
        {% endif %}
        
        | {% block titleblock %} {% endblock %}</title>
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/admin_dashboard.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/dashboard.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/forms.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/organization.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/alertmsgcss.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/media.css' %}">    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"/>

    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 
    
    <script src="{% static 'csp_app/js/sidebar.js' %}"></script>
    <script src="{% static 'csp_app/js/forms.js' %}"></script>
    <script src="{% static 'csp_app/js/inputs.js' %}"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <!-- datatable -->
    <link rel="stylesheet" type="text/css" href="{% static 'csp_app/css/tables.css' %}">

    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css"> -->
  
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/r/zf-5.5.2/jqc-1.11.3,dt-1.10.8/datatables.min.css"/>
 
		<script type="text/javascript" src="https://cdn.datatables.net/r/zf-5.5.2/jqc-1.11.3,dt-1.10.8/datatables.min.js"></script> -->

    <!-- datatable end -->
    <script>
      $(document).ready(function(){
        $('#entity-table').DataTable();
        $('#vendor-table').DataTable();
        $('#department-table').DataTable();
        $('#function-table').DataTable();
        $('#team-table').DataTable();
        $('#subteam-table').DataTable();
        $('#designation-table').DataTable();
        $('#region-table').DataTable();
        $('#state-table').DataTable();
        $('#city-table').DataTable();
        $('#location-table').DataTable();
        $('#user-table').DataTable();
        $('#candidate-table').DataTable();
        $('#document-table').DataTable();

        $('#c_firstname').bind('keypress', onlyAlphabets);
        $('#c_middlename').bind('keypress', onlyAlphabets);
        $('#c_lastname').bind('keypress', onlyAlphabets);
        $('#c_fathername').bind('keypress', onlyAlphabets);
        $('#spoc').bind('keypress', onlyAlphabets);
        $('#loc_name').bind('keypress', alphaNumeric);
        $('#firstname').bind('keypress', onlyAlphabets);
        $('#lastname').bind('keypress', onlyAlphabets);

        $('#name').bind('keypress', alphaNumeric);
        $('#search-bar').bind('keypress', noSpecial);

        $('#c_aadhaar').bind('keypress', onlyNumbers);
        $('#c_contact').bind('keypress', onlyNumbers);
        $('#c_emergency').bind('keypress', onlyNumbers);

        $('#c_salary').bind('keypress', money);

        $('#c_pan').keyup(function() { 
          this.value = this.value.toLocaleUpperCase(); 
        });
        // days
        $(function(){
          var dtToday = new Date(); 
          var month = dtToday.getMonth() + 1;
          var day = dtToday.getDate();
          var year = dtToday.getFullYear();
          if(month < 10)
              month = '0' + month.toString();
          if(day < 10)
              day = '0' + day.toString();          
          var minDate= year + '-' + month + '-' + day; 
          var adminDate = new Date(minDate);
          adminDate.setDate(adminDate.getDate() - 30);
          var m = adminDate.getMonth() + 1;
          var d = adminDate.getDate();
          var y = adminDate.getFullYear();
          if(m < 10)
              m = '0' + m.toString();
          if(d < 10)
              d = '0' + d.toString();          
          var admin_date= y + '-' + m + '-' + d; 
          var maxDate = new Date(minDate);
          maxDate.setDate(maxDate.getDate() + 90);
          var m = maxDate.getMonth() + 1;
          var d = maxDate.getDate();
          var y = maxDate.getFullYear();
          if(m < 10)
              m = '0' + m.toString();
          if(d < 10)
              d = '0' + d.toString();          
          var max_date= y + '-' + m + '-' + d; 
          $('#False').attr('min', minDate);
          $('#True').attr('min', admin_date);
          $('#True').attr('max', max_date);
          $('#False').attr('max', max_date);
        });
        //years
        $(function(){
          var dtToday = new Date(); 
          var month = dtToday.getMonth() + 1;
          var day = dtToday.getDate();
          var maxYear = dtToday.getFullYear() - 45;
          var minYear = dtToday.getFullYear() - 18;
          if(month < 10)
              month = '0' + month.toString();
          if(day < 10)
              day = '0' + day.toString();          
          var maxAge= maxYear + '-' + month + '-' + day;     
          var minAge= minYear + '-' + month + '-' + day;
          $('#c_dob').attr('min', maxAge);
          $('#c_dob').attr('max', minAge);

          var fToday = new Date(); 
          var month = fToday.getMonth() + 1;
          var day = fToday.getDate();
          var maxYear = fToday.getFullYear() - 100;
          var minYear = fToday.getFullYear() - 45;
          if(month < 10)
              month = '0' + month.toString();
          if(day < 10)
              day = '0' + day.toString();          
          var maxAge= maxYear + '-' + month + '-' + day;     
          var minAge= minYear + '-' + month + '-' + day;
          $('#c_father_dob').attr('min', maxAge);
          $('#c_father_dob').attr('max', minAge);
        });
      });
    </script>
</head>
<body>
    <div class="wrapper">
        <div class="top_navbar">
          <div class="top_menu">
            <div class="logo">
                <img src="{% static 'csp_app/images/udaanredlogo.png' %}" alt="Company Logo" style="width: 55px;"></a>
            </div>
            <div class="search-input">
              <input type="search" name="search_c" id="search-bar" maxlength="300" placeholder="search name, phone, email" list="all_candidates">
              <datalist id="hide" class="c_datalist">
                  {% if allcandidates %}          
                      {% for eachc in allcandidates %}                 
                          <option value="{{ eachc.pk }} "  style="outline: none !important;"> {{ eachc.pk }} | {{ eachc.First_Name }} {{ eachc.Last_Name }} | {{ eachc.Contact_Number }} | {{ eachc.Personal_Email_Id }} </option>
                      {% endfor %}       
                  {% endif %}
              </datalist>
            </div>
            <div class="user-div">
                <ul>
                {% if request.user.is_staff %}
                    <li><a href="{% url 'csp_app:entity' %}" title="Admin Dashboard"><i class="fas fa-user-shield"></i></a></li>
                    <!-- <li><a href="#">|</a></li> -->
                    <!-- <li><a href="#">Requests</a></li>
                    <li><a href="#">|</a></li> -->
                {% else %}
                    <li><a href="{% url 'csp_app:candidate' %}"><i class="fas fa-user"></i></a></li>
                {% endif %}
                    <li title="Logout"><a href="{% url 'csp_app:csp_logout' %}"><i class="fas fa-sign-out-alt"></i></a></li>
                </ul>
            </div>
          </div>
        </div>

        {% if allcandidates %}          
            {% for eachcandidate in allcandidates %} 
            <div  class="form_modal" id="{{ eachcandidate.pk }}">

                <div class="view_form_header">
                    <div class="forms-heading">
                        <h2>Candidate Details</h2>
                    </div>
                    <div class="hr_line">&nbsp;</div>            
                </div>
                <div class="view_form_content">
                    <fieldset class="fds">
                        <legend>Basic Details</legend>
                        <table>
                            <tr>
                                <td><label for="">Full Name : </label> {{ eachcandidate.First_Name }} {{ eachcandidate.Middle_Name }} {{ eachcandidate.Last_Name }}</td>
                            </tr>
                            <tr>
                                <td><label for="">Contact : </label> {{ eachcandidate.Contact_Number }} / {{ eachcandidate.Personal_Email_Id }}</td>
                            </tr>                        
                            <tr>
                                <td><label for="">Onboarding Status : </label> {{ eachcandidate.onboarding_status }}</td>
                            </tr>
                            
                        </table>                    
                    </fieldset>
                    <fieldset class="fds">
                        <legend>Other Details</legend>
                        <table>
                            <tr>
                                <td><label for="">Created By : </label> {{ eachcandidate.created_by }}</td>
                            </tr>
                            <tr>
                                <td><label for="">Created Date Time : </label> {{ eachcandidate.created_date_time }}</td>
                            </tr>
                            <tr>
                                <td><label for="">Modified By : </label> {{ eachcandidate.modified_by }}</td>
                            </tr>
                            <tr>
                                <td><label for="">Modified Date Time : </label> {{ eachcandidate.modified_date_time }}</td>
                            </tr>
                            
                        </table>                    
                    </fieldset>
                                
                </div>
                    
                <div class="view_form_footer">
                    <button onclick="window.location.reload();" class="forms-save-btn">Close</button>
                </div>
                        
            
            </div>
            {% endfor %}
        {% endif %}

        

        <!-- <div id="search-emp-panel" class="search-emp-panel_modal">
          <div class="search-emp-panel_modal_header">
              <span class="search-emp-panel-close" id="close-search-panel-span">&times;</span>
              Employee Details
          </div>
          <div class="search-emp-panel_modal-content">
              <div class="search_section">                  
                  {% if employees %}          
                      {% for eachemp in employees %} 
                          <div id="{{ eachemp.emp_code }}" style="display: none;" class="search-emp-contents">
                              <div>
                                  <table style="width: 100%;">
                                      <tr>
                                          <td rowspan="3" style="border-bottom: none;">
                                          <div>
                                              <img src="{% static 'Associate_app/images/dummy.png' %}" alt="Employee Photo" title="{{ eachemp.first_name }} {{ eachemp.middle_name }} {{ eachemp.last_name }} Photo" style="width: 200px; border-radius: 50%;">
                                          </div>
                                          </td>
                                          <td style="border-bottom: none;" ><i class="fas fa-address-card" title="UID"></i> {{ eachemp.emp_code }}</td>
                                          <td style="border-bottom: none;"><i class="fas fa-user" title="Employee Name"></i> {{ eachemp.first_name }} {{ eachemp.middle_name }} {{ eachemp.last_name }}</td>
                                          <td style="border-bottom: none;"><i class="fas fa-mobile-alt" title="Mobile Number"></i> {{ eachemp.mobile_number }}</td>
                                      </tr>
                                     <tr>                                           
                                         <td style="border-bottom: none;"><i class="fas fa-envelope" title="Official E-mail ID"></i> {{ eachemp.official_email }}</td>
                                         <td style="border-bottom: none;"><i class="fas fa-city" title="Company Name"></i> {{ eachemp.fk_company_code }}</td>
                                         <td style="border-bottom: none;"><i class="fas fa-briefcase" title="Function"></i> {{ eachemp.fk_function_code }}</td>
                                     </tr>
                                     <tr>
                                         <td style="border-bottom: none;"><i class="fas fa-user-tag" title="Role"></i> {{ eachemp.fk_role_code }}</td>
                                         <td style="border-bottom: none;"><i class="fas fa-portrait" title="Designation"></i> {{ eachemp.fk_designation_code }}</td>
                                         <td style="border-bottom: none;"></td>
                                     </tr>
                                 </table>

                              </div>
                          </div>
                      {% endfor %}
                  {% endif %}
              </div>
          </div>
          <div class="search-emp-panel_modal_footer">
              <button class="basic-save-btn" id="close-search-emp-panel" style="float: none;">Close</button>
          </div>
        </div> -->
        {% if request.user.is_staff %}
        <div class="sidebar">
            <ul>
            
              <li onclick="showMe('Organization', 'org-expand')" id="Organization"><a href="{% url 'csp_app:entity' %}">
                <span class="icon"><i class="fas fa-sitemap"></i></span>
                <span class="title">Organization</span><span class="expand"><i class="fas fa-caret-right" id="org-expand"></i></span></a></li>
              <li onclick="showMe('User', 'user-expand')" id="User"><a href="{% url 'csp_app:user' %}">
                <span class="icon"><i class="fas fa-users-cog"></i></span>
                <span class="title">User</span>
                <span class="expand"><i class="fas fa-caret-right" id="user-expand"></i></span></a></li>
             
              <li onclick="showMe('Candidate', 'can-expand')" id="Candidate"><a href="{% url 'csp_app:candidate' %}">
              <span class="icon"><i class="fas fa-users"></i></span>
              <span class="title">Candidate</span>
              <span class="expand"><i class="fas fa-caret-right" id="can-expand"></i></span></a></li>             
          </ul>
        </div>
        {% endif %}
        {% if request.user.groups.all %}
          {% for eachgroup in request.user.groups.all %}
            {% if eachgroup.name != 'Admin' %}
              <div class="main_container" style="margin-left: 0px;width:calc(100% - 20px);">
              {% else %}
              <div class="main_container">      
            {% endif %}
          {% endfor %}          
        {% endif %}
            <div class="item item_header">
                {% block bodyblock %} 
             
                {% endblock %}
            </div>
            <div class="item item_contents">

                {% block tabcontentblock %}
    
    
    
                {% endblock %}  
                {% if messages %}
                {% for msg in messages %}
                    {% if msg.tags == 'success' %}
                        <div id="alerts" class="alert alert-success alert-dismissible sucess-msg-alert animate__animated animate__slideInRight animate__fast" >
                            <table id="success-tbl">
                            <tr>
                                <td rowspan="2"><i class="fas fa-check-circle" style="padding: 15px; padding-left: 0px !important;"></i></td>
                                <td style="font-size: 16px; font-weight: bold;">Success</td>
                            </tr>
                            <tr>
                                <td>{{ msg }}</td>

                            </tr>
                            </table>
                            <button type="button" class="close" data-dismiss="alert" style="outline: none !important;"> &times;</button>

                        </div>
                    {% endif %}
                    {% if msg.tags == 'error' %}
                        <div id="alerts" class="alert alert-danger alert-dismissible error-msg-alert animate__animated animate__slideInRight animate__fast" >
                            <table id="failure-tbl">
                            <tr>
                                <td rowspan="2" style="border-bottom: none;"><i class="fas fa-times" style="padding: 15px; padding-left: 0px !important; font-family: 'Font Awesome 5 Free' !important;"></i></td>
                                <td style="font-size: 16px; font-weight: bold;border-bottom: none;">Error</td>

                            </tr>
                            <tr>
                                <td style="border-bottom: none;">{{ msg }}</td>
                            </tr>
                            </table>
                            <button type="button" class="close" data-dismiss="alert" style="outline: none !important;">&times;</button>

                        </div>
                    {% endif %}
                    {% if msg.tags == 'warning' %}
                        <div id="alerts" class="alert alert-warning alert-dismissible warning-msg-alert animate__animated animate__slideInRight animate__fast" >
                            <table id="warning-tbl">
                            <tr>
                                <td rowspan="2" style="border-bottom: none;"><i class="fas fa-times" style="padding: 15px; padding-left: 0px !important; font-family: 'Font Awesome 5 Free' !important;"></i></td>
                                <td style="font-size: 16px; font-weight: bold;border-bottom: none;">Warning</td>

                            </tr>
                            <tr>
                                <td style="border-bottom: none;">{{ msg }}</td>
                            </tr>
                            </table>
                            <button type="button" class="close" data-dismiss="alert" style="outline: none !important;">&times;</button>

                        </div>
                    {% endif %}

                {% endfor %}
            {% endif %}

                <!-- {% if messages %}
                  <ul class="messages">
                      {% for message in messages %}
                      <li{% if message.tags %} class="{{ message.tags }}"{% endif %} style="list-style: none;">{{ message }}</li>
                      {% endfor %}
                  </ul>
                {% endif %} -->
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function hidediv(){
                    $( '#alerts' ).removeClass( 'animate__animated animate__slideOutRight animate__fast' ).show().addClass( 'animate__animated animate__slideInRight animate__fast' );
    
                    $( '#alerts' ).removeClass( 'animate__animated animate__slideInRight animate__fast' ).addClass( 'animate__animated animate__slideOutRight animate__fast' );
                }
        setTimeout("hidediv()", 2000);    
    </script>
    <script type="text/javascript">
      
    document.addEventListener('DOMContentLoaded', function() { 
     
            var input = document.getElementById('name');
            input.addEventListener('keydown', function(e){      
                var input = e.target;
                var val = input.value;
                var end = input.selectionEnd;
                if(e.keyCode == 32 && (val[end - 1] == " " || val[end] == " ")) {
                    e.preventDefault();
                    return false;
                }   
                if(e.keyCode == 190 && (val[end - 1] == "." || val[end] == ".")) {
                    e.preventDefault();
                    return false;
                }      
            });
      
       
        var input = document.getElementById('c_firstname');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32 && (val[end - 1] == " " || val[end] == " ")) {
                e.preventDefault();
                return false;
            }   
            if(e.keyCode == 190) {
                e.preventDefault();
                return false;
            }      
        });
        var input = document.getElementById('c_middlename');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32 && (val[end - 1] == " " || val[end] == " ")) {
                e.preventDefault();
                return false;
            }   
            if(e.keyCode == 190) {
                e.preventDefault();
                return false;
            }      
        });
        var input = document.getElementById('c_lastname');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32 && (val[end - 1] == " " || val[end] == " ")) {
                e.preventDefault();
                return false;
            }   
            if(e.keyCode == 190) {
                e.preventDefault();
                return false;
            }      
        });
        var input = document.getElementById('c_fathername');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32 && (val[end - 1] == " " || val[end] == " ")) {
                e.preventDefault();
                return false;
            }   
            if(e.keyCode == 190) {
                e.preventDefault();
                return false;
            }      
        });
        
        var input = document.getElementById('email');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32) {
                e.preventDefault();
                return false;
            }     
        });
        var input = document.getElementById('phone_no');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32) {
                e.preventDefault();
                return false;
            }     
        });
        var input = document.getElementById('spocemail');
        input.addEventListener('keydown', function(e){      
            var input = e.target;
            var val = input.value;
            var end = input.selectionEnd;
            if(e.keyCode == 32) {
                e.preventDefault();
                return false;
            }     
        });
       
       
    });
    
      
    </script>
    <script>
        $(document).ready(function(){
            $('#search-bar').on('input', function() {
               
                if (this.value == ''){ 
                    $('.c_datalist').prop("id","hide");
                }
                if (this.value.length < 2){
                    $('.c_datalist').prop("id","hide");
                } else {
                    $('.c_datalist').prop("id","all_candidates");
                }
               
            });
            $('#search-bar').on('change', function() {
                console.log(this.value);
                var c_code = $('#search-bar').value;
                console.log(c_code);
               $('#' + this.value).css("display", "block");              
           });
        //    $(document).keyup(function(){
        //     if (event.keyCode === 27){
        //         $("#entity_form").css("display", "none");
        //         $("#delete_entity_form").css("display", "none");
        //     }
        //     });
        //     $(window).click(function(e) {
        //         if (e.target.id === 'entity_form' || e.target.id === 'delete_entity_form') {
        //             $("#entity_form").css("display", "none");
        //             $("#delete_entity_form").css("display", "none");
        //         }   
        //     }); 
        });
    </script>
</body>
</html>